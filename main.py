import json
import random
import requests
import schedule
import time
from datetime import datetime, timedelta
import os
import logging

# ุชูุธูุงุช ูุงฺฏูฺฏ
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# Bot configuration
token = "bot347312:925cb350-f0b4-43fd-96e4-204763b58135"
chat_id = "10362318"
base_url = f"https://eitaayar.ir/api/{token}"


# ูุณุฑ ูุงู JSON ุงููุงุช ุดุฑุน (ุจุง ูุณุฑ ูุณุจ)
base_dir = os.path.dirname(os.path.abspath(__file__))  # ูุณุฑ ุฏุงุฑฺฉุชูุฑ ูุนู (ูพูุดูโ ูพุฑูฺู)
prayer_times_file = os.path.join(base_dir, "data", "20.json")  # ูุณุฑ ูุงู JSON
START_DAY = 318  # ุฑูุฒ ุดุฑูุน

# ูุณุฑ ูพูุดูโ audio_files (ุจุง ูุณุฑ ูุณุจ)
audio_files_path = os.path.join(base_dir, "audio_files")

# ฺุงูพ ูุณุฑูุง ุจุฑุง ุจุฑุฑุณ
logging.info(f"ูุณุฑ ุฏุงุฑฺฉุชูุฑ ูพุฑูฺู: {base_dir}")
logging.info(f"ูุณุฑ ูพูุดูโ audio_files: {audio_files_path}")
logging.info(f"ูุณุฑ ูุงู ุงููุงุช ุดุฑุน: {prayer_times_file}")
)

# ูุงู ููุงุฒูุง ุจู ูุงุฑุณ
prayer_names = {
    "fajr": "ุตุจุญ",
    "dhuhr": "ุธูุฑ",
    "asr": "ุนุตุฑ",
    "maghrib": "ูุบุฑุจ",
    "isha": "ุนุดุงุก"
}

# ูุณุช ูพุงูโูุง ุชุตุงุฏู
random_messages = [
    "๐ ููุช ููุงุฒ ุงุณุช! ุจุง ู ุจุง ููุงุฒุช ููุจ ุฎูุฏ ุฑุง ุฑูุดู ฺฉู. ๐",
    "๐ ูุญุธูโุง ุจุง ุฎุฏุง ุจุงุดุ ููุงุฒุช ุฑุง ุจู ุฌุง ุจุงูุฑ. ๐",
    "๐ ููุงุฒ ุจูุชุฑู ูุฏูโุง ุงุณุช ฺฉู ูโุชูุงู ุจู ุฎูุฏุช ุจุฏู. ๐",
    "๐ ุจุง ููุงุฒุ ุขุฑุงูุด ุฑุง ุจู ุฒูุฏฺฏุช ุฏุนูุช ฺฉู. ๐",
    "๐ซ ููุงุฒุช ุฑุง ุจุฎูุงู ุชุง ููุฑ ุงูู ุฏุฑ ูุฌูุฏุช ุฌุงุฑ ุดูุฏ. ๐ซ",
    "๐ ููุช ุงุฐุงู ุงุณุชุ ุจุง ู ุฏุฑ ุฎุงูู ุฎุฏุง ุญุถูุฑ ูพุฏุง ฺฉู. ๐",
    "๐บ ููุงุฒุ ฺฏูโูุง ุจูุดุช ุฑุง ุฏุฑ ููุจ ุชู ูโฺฉุงุฑุฏ. ๐บ",
    "๐๏ธ ุจุง ููุงุฒุ ุจุงูโูุง ุขุฑุงูุด ุฑุง ุจุฑ ุฒูุฏฺฏโุงุช ุจฺฏุณุชุฑุงู. ๐๏ธ",
    "โจ ููุงุฒุ ุจูุชุฑู ุฑุงู ุจุฑุง ูุฒุฏฺฉ ุจู ุฎุฏุงุณุช. โจ",
    "๐ฟ ููุงุฒุช ุฑุง ุจุฎูุงู ุชุง ุฑูุญโุงุช ุชุงุฒู ุดูุฏ. ๐ฟ",
    "๐ฏ๏ธ ููุงุฒุ ููุฑ ุฑุงู ุฒูุฏฺฏโุงุช ุงุณุช. ๐ฏ๏ธ",
    "๐ ููุช ุงุฐุงู ุงุณุชุ ุจุง ู ุจุง ููุงุฒ ุฑูุฒุช ุฑุง ุฒุจุง ฺฉู. ๐",
    "๐ ููุงุฒุ ุฑูฺฏโูุง ุงูู ุฑุง ุจู ุฒูุฏฺฏโุงุช ูโุขูุฑุฏ. ๐",
    "๐ ุจุง ููุงุฒุ ุณุชุงุฑูโูุง ุขุฑุงูุด ุฑุง ุฏุฑ ุขุณูุงู ููุจโุงุช ุฑูุดู ฺฉู. ๐",
    "๐ ููุงุฒุ ุจูุชุฑู ูุญุธูโูุง ุฒูุฏฺฏโุงุช ุฑุง ูโุณุงุฒุฏ. ๐",
    "๐ท ููุงุฒุช ุฑุง ุจุฎูุงู ุชุง ฺฏูโูุง ุจูุดุช ุฏุฑ ููุจโุช ุดฺฉููุง ุดูุฏ. ๐ท",
    "๐ ููุช ุงุฐุงู ุงุณุชุ ุจุง ู ุจุง ููุงุฒ ุจู ุฎุฏุง ูุฒุฏฺฉ ุดู. ๐",
    "๐๏ธ ููุงุฒุ ุจุงูโูุง ุขุฑุงูุด ุฑุง ุจุฑ ุฒูุฏฺฏโุงุช ูโฺฏุณุชุฑุงูุฏ. ๐๏ธ",
    "๐ ููุงุฒุ ุจูุชุฑู ุฑุงู ุจุฑุง ุดุฑูุน ฺฉ ุฑูุฒ ุฒุจุงุณุช. ๐",
    "๐ ุจุง ููุงุฒุ ููุจโุงุช ุฑุง ุจุง ููุฑ ุงูู ุฑูุดู ฺฉู. ๐"
]

# Helper functions
def send_message(text):
    url = f"{base_url}/sendMessage"
    payload = {
        "chat_id": chat_id,
        "text": text,
    }
    try:
        logging.info(f"ุฏุฑ ุญุงู ุงุฑุณุงู ูพุงู: {text}")
        response = requests.post(url, json=payload)
        logging.info(f"ูพุงุณุฎ ุงุฑุณุงู ูพุงู: {response.status_code}")
        return response.json()
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ูพุงู: {e}")
        return None

def send_voice(file_path, caption=""):
    url = f"{base_url}/sendFile"
    try:
        logging.info(f"ุฏุฑ ุญุงู ุงุฑุณุงู ูุงู ุตูุช: {file_path}")
        with open(file_path, "rb") as file:
            files = {"file": file}
            payload = {"chat_id": chat_id, "caption": caption}
            response = requests.post(url, files=files, data=payload)
        logging.info(f"ูพุงุณุฎ ุงุฑุณุงู ูุงู ุตูุช: {response.status_code}")
        return response.json()
    except FileNotFoundError:
        logging.error(f"ูุงู ุตูุช ุงูุช ูุดุฏ: {file_path}")
        return None
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ูุงู ุตูุช: {e}")
        return None

# ุจุงุฑฺฏุฐุงุฑ ุงุทูุงุนุงุช ุงููุงุช ุดุฑุน ุงุฒ ูุงู JSON
def load_prayer_times():
    try:
        with open(prayer_times_file, "r", encoding="utf-8") as file:
            data = json.load(file)
            daily_data = data['data']
            today_info = next((day for day in daily_data if day['day'] == START_DAY), None)
            if today_info:
                return today_info
            else:
                logging.error(f"ุงุทูุงุนุงุช ุฑูุฒ {START_DAY} ุงูุช ูุดุฏ.")
                return None
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุฎูุงูุฏู ูุงู ุงููุงุช ุดุฑุน: {e}")
        return None

# ุงุฑุณุงู ุงููุงุช ุดุฑุน ุจู ุตูุฑุช ฺฉู ุฏุฑ ุงุจุชุฏุง ุฑูุฒ
def send_daily_prayer_times():
    try:
        today_info = load_prayer_times()
        if today_info:
            message = f"""
            ๐ ุงููุงุช ุดุฑุน ุฑูุฒ {today_info['day']}:
            ๐ ุงุฐุงู ุตุจุญ: {today_info['fajr']}
            โ๏ธ ุทููุน ุขูุชุงุจ: {today_info['sunrise']}
            ๐ฐ๏ธ ุงุฐุงู ุธูุฑ: {today_info['dhuhr']}
            ๐ ุงุฐุงู ุนุตุฑ: {today_info['asr']}
            ๐ ุงุฐุงู ูุบุฑุจ: {today_info['maghrib']}
            ๐ ุงุฐุงู ุนุดุงุก: {today_info['isha']}
            """
            send_message(message)
        else:
            logging.warning("ุงุทูุงุนุงุช ุงููุงุช ุดุฑุน ุจุฑุง ุงูุฑูุฒ ุงูุช ูุดุฏ.")
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุงููุงุช ุดุฑุน ุฑูุฒุงูู: {e}")

# ุงุฑุณุงู ุงููุงุช ุดุฑุน ุจุฑุง ูุฑ ููุงุฒ ุฏุฑ ููุช ูุดุฎุต
def send_prayer_time_notification(prayer_name, prayer_time):
    try:
        logging.info(f"ุฏุฑ ุญุงู ุงุทูุงุนโุฑุณุงู ุฒูุงู ููุงุฒ: {prayer_name}")
        random_message = random.choice(random_messages)
        text = f"๐ ููุงุฒ {prayer_names[prayer_name]} ๐\nโฐ ุฒูุงู ููุงุฒ: {prayer_time}\n\n{random_message}"
        send_message(text)
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุทูุงุนโุฑุณุงู ุฒูุงู ููุงุฒ: {e}")

# ุงุฑุณุงู ูพุงู ุชุดูู ูู ุณุงุนุช ูุจู ุงุฒ ููุงุฒ
def send_reminder_notification(prayer_name, prayer_time):
    try:
        logging.info(f"ุฏุฑ ุญุงู ุงุทูุงุนโุฑุณุงู ูู ุณุงุนุช ูุจู ุงุฒ ููุงุฒ: {prayer_name}")
        reminder_time = (datetime.strptime(prayer_time, "%H:%M:%S") - timedelta(minutes=30)).strftime("%H:%M:%S")
        text = f"โณ ูู ุณุงุนุช ุฏฺฏุฑ ุฒูุงู ููุงุฒ {prayer_names[prayer_name]} ูุฑุง ูโุฑุณุฏ. โณ\n\n๐ ุขูุงุฏู ุดูุฏ ู ุจุง ุญุถูุฑ ููุจ ููุงุฒ ุฑุง ุจู ุฌุง ุขูุฑุฏ. ๐\n\n๐ซ \"ููุงุฒ ุณุชูู ุฏู ุงุณุชุ ูพุณ ุขู ุฑุง ุจุง ุญุถูุฑ ููุจ ุจู ุฌุง ุขูุฑุฏ.\" ๐ซ"
        send_message(text)
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุทูุงุนโุฑุณุงู ูู ุณุงุนุช ูุจู ุงุฒ ููุงุฒ: {e}")

# ุงุฑุณุงู ุฏุนุงูุง
def send_supplication(voice_file, caption):
    logging.info(f"ุฏุฑ ุญุงู ุงุฑุณุงู ุฏุนุง: {caption}")
    send_voice(voice_file, caption)

# ุงุฑุณุงู ุขู ุชุตุงุฏู
def random_quranic_verse():
    verses = [
        {
            "verse": "ุฅูููู ููุนู ุงููุนูุณูุฑู ููุณูุฑูุง",
            "interpretation": "๐ ุชูุณุฑ ููุฑ: ูุฑ ุณุฎุช ููุฑุงู ุจุง ุขุณุงู ุงุณุช. ุงู ุขู ุจู ูุง ุงูุฏ ูโุฏูุฏ ฺฉู ูพุณ ุงุฒ ูุฑ ูุดฺฉูุ ุฑุงูโุญู ูุฌูุฏ ุฏุงุฑุฏ."
        },
        {
            "verse": "ูููููู ููุชูููู ุงูููููู ููุฌูุนููู ูููู ููุฎูุฑูุฌูุง",
            "interpretation": "๐ ุชูุณุฑ ุงููุงุฑุงููุฑุขู: ูุฑ ฺฉุณ ุชููุง ุงูู ูพุดู ฺฉูุฏุ ุฎุฏุงููุฏ ุฑุงู ูุฌุงุช ุฑุง ุจุฑุง ุงู ูุฑุงูู ูโฺฉูุฏ."
        },
        {
            "verse": "ููุชูููฺฉูููู ุนูููู ุงููุญููู ุงูููุฐู ููุง ููููุชู",
            "interpretation": "๐ ุชูุณุฑ ููุฑ: ุจุฑ ุฎุฏุงููุฏ ุฒูุฏูโุง ฺฉู ูุฑฺฏุฒ ููโูุฑุฏุ ุชูฺฉู ฺฉู. ุงู ุขู ุจู ูุง ุงุฏุขูุฑ ูโฺฉูุฏ ฺฉู ุชููุง ุชฺฉูโฺฏุงู ูุง ุฎุฏุงุณุช."
        },
        {
            "verse": "ูููู ูููู ุงูููููู ุฃูุญูุฏู",
            "interpretation": "๐ ุชูุณุฑ ุงููุงุฑุงููุฑุขู: ุจฺฏู ุงู ุงููู ฺฉุชุงุณุช. ุงู ุณูุฑู ุจุงูฺฏุฑ ุชูุญุฏ ู ฺฏุงูฺฏ ุฎุฏุงููุฏ ุงุณุช."
        },
        
    {
        "verse": "๐ ุงูููููู ููุง ุฅููููฐูู ุฅููููุง ูููู ุงููุญูููู ุงูููููููููู  ููุง ุชูุฃูุฎูุฐููู ุณูููุฉู ููููุง ูููููู  ูููู ููุง ููู ุงูุณููููุงููุงุชู ููููุง ููู ุงููุฃูุฑูุถู  ูููู ุฐูุง ุงูููุฐูู ููุดูููุนู ุนูููุฏููู ุฅููููุง ุจูุฅูุฐููููู  ููุนููููู ููุง ุจููููู ุฃูููุฏูููููู ููููุง ุฎููููููููู  ููููุง ููุญููุทูููู ุจูุดูููุกู ูููู ุนููููููู ุฅููููุง ุจูููุง ุดูุงุกู  ููุณูุนู ููุฑูุณูููููู ุงูุณููููุงููุงุชู ููุงููุฃูุฑูุถู  ููููุง ููุฆููุฏููู ุญูููุธูููููุง  ูููููู ุงููุนูููููู ุงููุนูุธูููู",
        "interpretation": "๐ ุงู ุขู ุนุธูุช ู ูุฏุฑุช ุจโูพุงุงู ุฎุฏุงููุฏ ุฑุง ุชูุตู ูโฺฉูุฏ. ุฎุฏุงููุฏ ุฒูุฏู ู ูุงุฆู ุจู ุฐุงุช ุงุณุช ู ูฺโฺฉุณ ุจุฏูู ุงุฌุงุฒู ุงู ููโุชูุงูุฏ ุดูุงุนุช ฺฉูุฏ. ุนูู ุงู ููู ฺุฒ ุฑุง ุฏุฑ ุจุฑ ูโฺฏุฑุฏ ู ุญูุธ ุขุณูุงูโูุง ู ุฒูู ุจุฑุง ุงู ุขุณุงู ุงุณุช. ๐"
    },
    {
        "verse": "๐ ููุง ููููููููู ุงูููููู ููููุณูุง ุฅููููุง ููุณูุนูููุง  ููููุง ููุง ููุณูุจูุชู ููุนูููููููุง ููุง ุงููุชูุณูุจูุชู  ุฑูุจููููุง ููุง ุชูุคูุงุฎูุฐูููุง ุฅููู ููุณููููุง ุฃููู ุฃูุฎูุทูุฃูููุง  ุฑูุจููููุง ููููุง ุชูุญููููู ุนูููููููุง ุฅูุตูุฑูุง ููููุง ุญูููููุชููู ุนูููู ุงูููุฐูููู ูููู ููุจูููููุง  ุฑูุจููููุง ููููุง ุชูุญููููููููุง ููุง ููุง ุทูุงููุฉู ููููุง ุจููู  ููุงุนููู ุนููููุง ููุงุบูููุฑู ููููุง ููุงุฑูุญูููููุง  ุฃูููุชู ููููููุงููุง ููุงููุตูุฑูููุง ุนูููู ุงูููููููู ุงููููุงููุฑูููู",
        "interpretation": "๐ฟ ุฎุฏุงููุฏ ุจู ูุฑฺฉุณ ุชููุง ุจู ุงูุฏุงุฒู ุชูุงูุงโุงุด ุชฺฉูู ูโุฏูุฏ. ุงู ุขู ุฏุนุง ุฒุจุง ุจุฑุง ุทูุจ ุขูุฑุฒุดุ ุฑุญูุช ู ุงุฑ ุงุฒ ุฎุฏุงููุฏ ุงุณุช. ๐"
    },
    {
        "verse": "๐ ุดูููุฏู ุงูููููู ุฃูููููู ููุง ุฅููููฐูู ุฅููููุง ูููู ููุงููููููุงุฆูููุฉู ููุฃููููู ุงููุนููููู ููุงุฆูููุง ุจูุงููููุณูุทู  ููุง ุฅููููฐูู ุฅููููุง ูููู ุงููุนูุฒููุฒู ุงููุญูููููู",
        "interpretation": "๐๏ธ ุฎุฏุงููุฏุ ูุฑุดุชฺฏุงู ู ุตุงุญุจุงู ุนูู ฺฏูุงู ูโุฏููุฏ ฺฉู ูฺ ูุนุจูุฏ ุฌุฒ ุงู ูุณุช. ุงู ุนุฒุฒ ู ุญฺฉู ุงุณุช ู ุจู ุนุฏุงูุช ุจุฑูพุงุณุช. โจ"
    },
    {
        "verse": "๐ ููููุชููููู ูููููููู ุฃููููุฉู ููุฏูุนูููู ุฅูููู ุงููุฎูููุฑู ููููุฃูููุฑูููู ุจูุงููููุนูุฑูููู ูููููููููููู ุนููู ุงููููููููุฑู  ููุฃูููููฐุฆููู ูููู ุงููููููููุญูููู",
        "interpretation": "๐บ ุงู ุขู ุฏุนูุช ุจู ุชุดฺฉู ุฌุงูุนูโุง ูโฺฉูุฏ ฺฉู ุจู ุฎุฑ ุฏุนูุช ฺฉูุฏุ ุงูุฑ ุจู ูุนุฑูู ู ูู ุงุฒ ููฺฉุฑ ููุงุฏ. ฺูู ุงูุฑุงุฏ ุฑุณุชฺฏุงุฑ ุฎูุงููุฏ ุจูุฏ. ๐"
    },
    {
        "verse": "๐ ููุงูููุฐูููู ุฅูุฐูุง ููุนููููุง ููุงุญูุดูุฉู ุฃููู ุธููููููุง ุฃูููููุณููููู ุฐูููุฑููุง ุงูููููู ููุงุณูุชูุบูููุฑููุง ููุฐููููุจููููู ูููููู ููุบูููุฑู ุงูุฐูููููุจู ุฅููููุง ุงูููููู ูููููู ููุตูุฑูููุง ุนูููููฐ ููุง ููุนููููุง ูููููู ููุนูููููููู",
        "interpretation": "๐ง ุงู ุขู ุฏุฑุจุงุฑู ุชูุจู ฺฉููุฏฺฏุงู ุงุณุช ฺฉู ูพุณ ุงุฒ ุงุฑุชฺฉุงุจ ฺฏูุงูุ ุจู ุงุฏ ุฎุฏุง ูโุงูุชูุฏ ู ุงุณุชุบูุงุฑ ูโฺฉููุฏ. ุฎุฏุงููุฏ ุชููุง ฺฉุณ ุงุณุช ฺฉู ฺฏูุงูุงู ุฑุง ูโุจุฎุดุฏ. ๐"
    },
    {
        "verse": "๐ ููุจูููุง ุฑูุญูููุฉู ูููู ุงูููููู ููููุชู ูููููู  ูููููู ููููุชู ููุธููุง ุบููููุธู ุงููููููุจู ููุงููููุถูููุง ูููู ุญููููููู  ููุงุนููู ุนููููููู ููุงุณูุชูุบูููุฑู ูููููู ููุดูุงููุฑููููู ููู ุงููุฃูููุฑู  ููุฅูุฐูุง ุนูุฒูููุชู ููุชูููููููู ุนูููู ุงูููููู  ุฅูููู ุงูููููู ููุญูุจูู ุงููููุชููููููููููู",
        "interpretation": "๐ค ุงู ุขู ุจู ูพุงูุจุฑ(ุต) ุชูุตู ูโฺฉูุฏ ฺฉู ุจุง ูุฑุฏู ุจุง ูุฑู ุฑูุชุงุฑ ฺฉูุฏุ ุงุฒ ุขูโูุง ุฏุฑุฎูุงุณุช ุนูู ููุงุฏ ู ุฏุฑ ุงููุฑ ุจุง ุขูโูุง ูุดูุฑุช ฺฉูุฏ. ุชูฺฉู ุจุฑ ุฎุฏุงููุฏ ูพุณ ุงุฒ ุชุตููโฺฏุฑ ูุฒ ููุฑุฏ ุชุฃฺฉุฏ ุงุณุช. ๐"
    },
    {
        "verse": "๐ ููุง ุฃููููููุง ุงูููุฐูููู ุขูููููุง ููุง ุชูุฃููููููุง ุฃูููููุงูููููู ุจููููููููู ุจูุงููุจูุงุทููู ุฅููููุง ุฃููู ุชูููููู ุชูุฌูุงุฑูุฉู ุนููู ุชูุฑูุงุถู ูููููููู  ููููุง ุชูููุชููููุง ุฃูููููุณููููู  ุฅูููู ุงูููููู ููุงูู ุจููููู ุฑูุญููููุง",
        "interpretation": "๐ฐ ุงู ุขู ุจู ูุคููุงู ูุดุฏุงุฑ ูโุฏูุฏ ฺฉู ุงููุงู ฺฉุฏฺฏุฑ ุฑุง ุจู ูุงุญู ูุฎูุฑูุฏ ู ุงุฒ ุฎูุฏฺฉุด ุจูพุฑูุฒูุฏ. ุฎุฏุงููุฏ ูุณุจุช ุจู ุจูุฏฺฏุงูุด ููุฑุจุงู ุงุณุช. โค๏ธ"
    },
    {
        "verse": "๐ ููุงุนูุจูุฏููุง ุงูููููู ููููุง ุชูุดูุฑููููุง ุจููู ุดูููุฆูุง  ููุจูุงููููุงููุฏููููู ุฅูุญูุณูุงููุง ููุจูุฐูู ุงููููุฑูุจูููฐ ููุงููููุชูุงููููฐ ููุงููููุณูุงููููู ููุงููุฌูุงุฑู ุฐูู ุงููููุฑูุจูููฐ ููุงููุฌูุงุฑู ุงููุฌูููุจู ููุงูุตููุงุญูุจู ุจูุงููุฌูููุจู ููุงุจููู ุงูุณููุจูููู ููููุง ููููููุชู ุฃูููููุงูููููู  ุฅูููู ุงูููููู ููุง ููุญูุจูู ูููู ููุงูู ููุฎูุชูุงููุง ููุฎููุฑูุง",
        "interpretation": "โค๏ธ ุงู ุขู ุจู ุนุจุงุฏุช ุฎุฏุงููุฏ ู ูฺฉ ุจู ูุงูุฏูุ ุฎูุดุงููุฏุงูุ ุชูุงูุ ููุฑุง ู ููุณุงฺฏุงู ุชุฃฺฉุฏ ูโฺฉูุฏ. ุฎุฏุงููุฏ ุงุฒ ุงูุฑุงุฏ ูุชฺฉุจุฑ ู ูุฎุฑูุฑูุด ุจุฒุงุฑ ุงุณุช. ๐ธ"
    },
    {
        "verse": "๐ ููุง ุฃููููููุง ุงูููุฐูููู ุขูููููุง ููููููุง ูููููุงููููู ุจูุงููููุณูุทู ุดูููุฏูุงุกู ููููููู ูููููู ุนูููููฐ ุฃูููููุณููููู ุฃููู ุงููููุงููุฏููููู ููุงููุฃูููุฑูุจูููู  ุฅููู ูููููู ุบููููููุง ุฃููู ูููููุฑูุง ููุงูููููู ุฃูููููููฐ ุจูููููุง  ููููุง ุชูุชููุจูุนููุง ุงููููููููฐ ุฃููู ุชูุนูุฏููููุง  ููุฅููู ุชููููููุง ุฃููู ุชูุนูุฑูุถููุง ููุฅูููู ุงูููููู ููุงูู ุจูููุง ุชูุนูููููููู ุฎูุจููุฑูุง",
        "interpretation": "โ๏ธ ุงู ุขู ุจู ุนุฏุงูุช ู ุดูุงุฏุช ุจู ุญู ุญุช ุนูู ุฎูุฏ ุง ูุฒุฏฺฉุงู ุชุฃฺฉุฏ ูโฺฉูุฏ. ุฎุฏุงููุฏ ุงุฒ ููู ุงุนูุงู ูุง ุขฺฏุงู ุงุณุช. ๐"
    },
    {
        "verse": "๐ ููููููุฏู ุฃูุฎูุฐู ุงูููููู ูููุซูุงูู ุจูููู ุฅูุณูุฑูุงุฆูููู ููุจูุนูุซูููุง ูููููููู ุงุซููููู ุนูุดูุฑู ูููููุจูุง  ููููุงูู ุงูููููู ุฅููููู ููุนููููู  ููุฆููู ุฃูููููุชููู ุงูุตููููุงุฉู ููุขุชูููุชููู ุงูุฒููููุงุฉู ููุขููููุชููู ุจูุฑูุณูููู ููุนูุฒููุฑูุชูููููููู ููุฃูููุฑูุถูุชููู ุงูููููู ููุฑูุถูุง ุญูุณูููุง ููุฃููููููุฑูููู ุนููููููู ุณููููุฆูุงุชููููู ููููุฃูุฏูุฎูููููููููู ุฌููููุงุชู ุชูุฌูุฑูู ูููู ุชูุญูุชูููุง ุงููุฃูููููุงุฑู  ูููููู ููููุฑู ุจูุนูุฏู ุฐููฐูููู ูููููููู ููููุฏู ุถูููู ุณูููุงุกู ุงูุณููุจูููู",
        "interpretation": "๐ ุงู ุขู ุฏุฑุจุงุฑู ูพูุงู ุฎุฏุงููุฏ ุจุง ุจูโุงุณุฑุงุฆู ู ูุนุฏูโูุง ุงู ุจู ุขูโูุงุณุช. ุงูุฌุงู ููุงุฒุ ุฒฺฉุงุช ู ุงูุงู ุจู ูพุงูุจุฑุงู ุงุฒ ุดุฑุงุท ุงู ูพูุงู ุงุณุช. ๐ฟ"
    },
    {
        "verse": "๐ ูููู ุฃูุฌููู ุฐููฐูููู ููุชูุจูููุง ุนูููููฐ ุจูููู ุฅูุณูุฑูุงุฆูููู ุฃูููููู ูููู ููุชููู ููููุณูุง ุจูุบูููุฑู ููููุณู ุฃููู ููุณูุงุฏู ููู ุงููุฃูุฑูุถู ููููุฃููููููุง ููุชููู ุงููููุงุณู ุฌููููุนูุง ูููููู ุฃูุญูููุงููุง ููููุฃููููููุง ุฃูุญูููุง ุงููููุงุณู ุฌููููุนูุง  ููููููุฏู ุฌูุงุกูุชููููู ุฑูุณูููููุง ุจูุงููุจููููููุงุชู ุซูููู ุฅูููู ููุซููุฑูุง ูููููููู ุจูุนูุฏู ุฐููฐูููู ููู ุงููุฃูุฑูุถู ููููุณูุฑูููููู",
        "interpretation": "๐๏ธ ุงู ุขู ุงุฑุฒุด ุฒูุฏฺฏ ุงูุณุงู ุฑุง ุจุงู ูโฺฉูุฏ. ฺฉุดุชู ฺฉ ููุฑ ุจุฑุงุจุฑ ุจุง ฺฉุดุชู ููู ุงูุณุงูโูุงุณุช ู ูุฌุงุช ฺฉ ููุฑ ุจุฑุงุจุฑ ุจุง ูุฌุงุช ููู ุงูุณุงูโูุง. ๐"
    },
    {
        "verse": "๐ ููุง ุฃููููููุง ุงูููุฐูููู ุขูููููุง ูููู ููุฑูุชูุฏูู ูููููููู ุนููู ุฏูููููู ููุณููููู ููุฃูุชูู ุงูููููู ุจููููููู ููุญูุจูููููู ููููุญูุจููููููู ุฃูุฐููููุฉู ุนูููู ุงููููุคูููููููู ุฃูุนูุฒููุฉู ุนูููู ุงููููุงููุฑูููู ููุฌูุงููุฏูููู ููู ุณูุจูููู ุงูููููู ููููุง ููุฎูุงููููู ููููููุฉู ููุงุฆููู  ุฐููฐูููู ููุถููู ุงูููููู ููุคูุชูููู ูููู ููุดูุงุกู  ููุงูููููู ููุงุณูุนู ุนูููููู",
        "interpretation": "๐ก๏ธ ุงู ุขู ุฏุฑุจุงุฑู ุฌุงฺฏุฒู ูุคููุงู ุตุงูุญ ุจู ุฌุง ูุฑุชุฏุงู ุงุณุช. ุขูโูุง ุจุง ุนุดู ุจู ุฎุฏุง ู ูุคููุงู ู ุฏุดูู ุจุง ฺฉุงูุฑุงูุ ุฏุฑ ุฑุงู ุฎุฏุง ุฌูุงุฏ ูโฺฉููุฏ. ๐"
    },
    {
        "verse": "๐ ููููุง ุฌูุนููููู ุงูููููู ุฅููููุง ุจูุดูุฑูููฐ ูููููู ููููุชูุทูููุฆูููู ูููููุจููููู ุจููู  ููููุง ุงููููุตูุฑู ุฅููููุง ูููู ุนูููุฏู ุงูููููู  ุฅูููู ุงูููููู ุนูุฒููุฒู ุญูููููู",
        "interpretation": "๐ ุงู ุขู ุจู ูุคููุงู ููุฏ ูพุฑูุฒ ู ุขุฑุงูุด ููุจ ูโุฏูุฏ. ูพุฑูุฒ ุชููุง ุงุฒ ุฌุงูุจ ุฎุฏุงููุฏ ุงุณุช ู ุงู ุนุฒุฒ ู ุญฺฉู ุงุณุช. ๐"
    },
    {
        "verse": "๐ ููููุง ุชูุฌูุงุฏููููุง ุฃููููู ุงููููุชูุงุจู ุฅููููุง ุจูุงูููุชูู ูููู ุฃูุญูุณููู ุฅููููุง ุงูููุฐูููู ุธููููููุง ูููููููู  ููููููููุง ุขูููููุง ุจูุงูููุฐูู ุฃูููุฒููู ุฅูููููููุง ููุฃูููุฒููู ุฅููููููููู ููุฅููููฐููููุง ููุฅููููฐูููููู ููุงุญูุฏู ููููุญููู ูููู ููุณูููููููู",
        "interpretation": "๐คฒ ุงู ุขู ุจู ูุคููุงู ุชูุตู ูโฺฉูุฏ ฺฉู ุจุง ุงูู ฺฉุชุงุจ ุจู ูฺฉูุชุฑู ุฑูุด ุจุญุซ ฺฉููุฏ ู ุงูุงู ุฎูุฏ ุฑุง ุจู ฺฉุชุงุจโูุง ุขุณูุงู ู ูุญุฏุงูุช ุฎุฏุงููุฏ ุงุนูุงู ููุงูุฏ. ๐"
    },
    {
        "verse": "๐ ูููููู ุขููุงุชููู ุฎููููู ุงูุณููููุงููุงุชู ููุงููุฃูุฑูุถู ููุงุฎูุชูููุงูู ุฃูููุณูููุชููููู ููุฃูููููุงูููููู  ุฅูููู ููู ุฐููฐูููู ููุขููุงุชู ููููุนูุงููููููู",
        "interpretation": "๐ ุงู ุขู ุจู ูุดุงููโูุง ุฎุฏุงููุฏ ุฏุฑ ุขูุฑูุด ุขุณูุงูโูุงุ ุฒููุ ุฒุจุงูโูุง ู ุฑูฺฏโูุง ูุฎุชูู ุงูุณุงูโูุง ุงุดุงุฑู ูโฺฉูุฏ. ุงู ูุดุงููโูุง ุจุฑุง ุฏุงูุดููุฏุงู ูุงุจู ุฏุฑฺฉ ุงุณุช. ๐"
    },
    {
        "verse": "๐ ุฅูููู ุงูููุฐูููู ููููุฑููุง ุจูุงูุฐููููุฑู ูููููุง ุฌูุงุกููููู  ููุฅูููููู ููููุชูุงุจู ุนูุฒููุฒู",
        "interpretation": "๐ ุงู ุขู ุฏุฑุจุงุฑู ฺฉุงูุฑุงู ุงุณุช ฺฉู ูุฑุขู ุฑุง ุงูฺฉุงุฑ ฺฉุฑุฏูุฏุ ุฏุฑ ุญุงู ฺฉู ุงู ฺฉุชุงุจ ุนุฒุฒ ู ุดฺฉุณุชโูุงูพุฐุฑ ุงุณุช. ๐"
    },
    {
        "verse": "๐ ูููู ููุง ุนูุจูุงุฏููู ุงูููุฐูููู ุฃูุณูุฑููููุง ุนูููููฐ ุฃูููููุณููููู ููุง ุชูููููุทููุง ูููู ุฑูุญูููุฉู ุงูููููู  ุฅูููู ุงูููููู ููุบูููุฑู ุงูุฐูููููุจู ุฌููููุนูุง  ุฅูููููู ูููู ุงููุบููููุฑู ุงูุฑููุญูููู",
        "interpretation": "๐ ุงู ุขู ุจู ุจูุฏฺฏุงู ฺฏูุงูฺฉุงุฑ ุงูุฏ ูโุฏูุฏ ฺฉู ุงุฒ ุฑุญูุช ุฎุฏุงููุฏ ูุงุงูุฏ ูุดููุฏุ ุฒุฑุง ุงู ููู ฺฏูุงูุงู ุฑุง ูโุจุฎุดุฏ. ๐ธ"
    },
    {
        "verse": "๐ ููููุฐููฐูููู ุฃูููุญูููููุง ุฅููููููู ููุฑูุขููุง ุนูุฑูุจููููุง ููุชูููุฐูุฑู ุฃูููู ุงููููุฑูููฐ ูููููู ุญูููููููุง ููุชูููุฐูุฑู ูููููู ุงููุฌูููุนู ููุง ุฑูููุจู ููููู  ููุฑูููู ููู ุงููุฌููููุฉู ููููุฑูููู ููู ุงูุณููุนููุฑู",
        "interpretation": "๐ฅ ุงู ุขู ุฏุฑุจุงุฑู ูุฒูู ูุฑุขู ุจู ุฒุจุงู ุนุฑุจ ู ูุดุฏุงุฑ ุจู ูุฑุฏู ูฺฉู ู ุงุทุฑุงู ุขู ุฏุฑุจุงุฑู ุฑูุฒ ูุงูุช ุงุณุช. ุฏุฑ ุขู ุฑูุฒุ ฺฏุฑูู ุจู ุจูุดุช ู ฺฏุฑูู ุจู ุฌููู ุฎูุงููุฏ ุฑูุช. ๐"
    },
    {
        "verse": "๐ ุฅูููู ุงููููุตููุฏููููููู ููุงููููุตููุฏููููุงุชู ููุฃูููุฑูุถููุง ุงูููููู ููุฑูุถูุง ุญูุณูููุง ููุถูุงุนููู ูููููู ูููููููู ุฃูุฌูุฑู ููุฑูููู",
        "interpretation": "๐ฐ ุงู ุขู ุจู ูุฑุฏุงู ู ุฒูุงู ฺฉู ุตุฏูู ูโุฏููุฏ ู ูุฑุถ ุงูุญุณูู ูโูพุฑุฏุงุฒูุฏุ ูุนุฏู ูพุงุฏุงุด ูุถุงุนู ู ฺฉุฑุงูุช ูโุฏูุฏ. ๐"
    },
    {
        "verse": "๐ ุฅููููููุง ุงููููุฌูููููฐ ูููู ุงูุดููููุทูุงูู ููููุญูุฒููู ุงูููุฐูููู ุขูููููุง ููููููุณู ุจูุถูุงุฑูููููู ุดูููุฆูุง ุฅููููุง ุจูุฅูุฐููู ุงูููููู  ููุนูููู ุงูููููู ููููููุชูููููููู ุงููููุคูููููููู",
        "interpretation": "๐ก๏ธ ุงู ุขู ุฏุฑุจุงุฑู ูุฌูุงูุง ูพููุงู ุงุณุช ฺฉู ุงุฒ ุดุทุงู ุณุฑฺุดูู ูโฺฏุฑุฏ ู ุจุงุนุซ ูุงุฑุงุญุช ูุคููุงู ูโุดูุฏ. ุงูุง ูุคููุงู ุจุงุฏ ุชููุง ุจุฑ ุฎุฏุง ุชูฺฉู ฺฉููุฏ. ๐"
    }

        
    ]
    try:
        logging.info("ุฏุฑ ุญุงู ุงุฑุณุงู ุขู ุชุตุงุฏู...")
        verse = random.choice(verses)
        text = f"๐ ุขู ุงูุฑูุฒ:\n\"{verse['verse']}\"\n\n๐ ุชูุณุฑ:\n{verse['interpretation']}\n\n๐ ุงุฒ ุงู ุขู ุฏุฑุณ ุจฺฏุฑุฏ ู ุฏุฑ ุฒูุฏฺฏ ุฎูุฏ ุจู ฺฉุงุฑ ุจุจูุฏุฏ! ๐"
        send_message(text)
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุขู ุชุตุงุฏู: {e}")

# ุฒูุงูโุจูุฏ ูุธุงู
def schedule_tasks():
    try:
        logging.info("ุฏุฑ ุญุงู ุชูุธู ุฒูุงูโุจูุฏโูุง...")
        today_info = load_prayer_times()
        if not today_info:
            logging.warning("ุงุทูุงุนุงุช ุงููุงุช ุดุฑุน ุจุฑุง ุงูุฑูุฒ ุงูุช ูุดุฏ.")
            return

        # ุงุฑุณุงู ุงููุงุช ุดุฑุน ุฏุฑ ุงุจุชุฏุง ุฑูุฒ
        schedule.every().day.at("00:01").do(send_daily_prayer_times)

        # ุฒูุงูโุจูุฏ ุงุทูุงุนโุฑุณุงู ุฒูุงู ูุฑ ููุงุฒ
        for prayer, time in today_info.items():
            if prayer in prayer_names:
                try:
                    schedule.every().day.at(time).do(
                        send_prayer_time_notification,
                        prayer,  # ูุงู ููุงุฒ
                        time  # ุฒูุงู ููุงุฒ
                    )
                    logging.info(f"ุฒูุงูโุจูุฏ ุงุทูุงุนโุฑุณุงู ููุงุฒ {prayer_names[prayer]} ุจุฑุง ุณุงุนุช {time} ุชูุธู ุดุฏ.")
                except Exception as e:
                    logging.error(f"ุฎุทุง ุฏุฑ ุฒูุงูโุจูุฏ ููุงุฒ {prayer_names[prayer]}: {e}")

                # ุฒูุงูโุจูุฏ ุงุทูุงุนโุฑุณุงู ูู ุณุงุนุช ูุจู ุงุฒ ููุงุฒ
               
                reminder_time = (datetime.strptime(time, "%H:%M:%S") - timedelta(minutes=30)).strftime("%H:%M:%S")
                schedule.every().day.at(reminder_time).do(
                    send_reminder_notification,
                    prayer,  # ูุงู ููุงุฒ
                    time  # ุฒูุงู ููุงุฒ
                )
                logging.info(f"ุฒูุงูโุจูุฏ ุงุทูุงุนโุฑุณุงู ูู ุณุงุนุช ูุจู ุงุฒ ููุงุฒ {prayer_names[prayer]} ุจุฑุง ุณุงุนุช {reminder_time} ุชูุธู ุดุฏ.")

        # ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ุตุจุญ ุจุนุฏ ุงุฒ ููุงุฒ ุตุจุญ
        fajr_time = today_info['fajr']
        fajr_time_dt = datetime.strptime(fajr_time, "%H:%M:%S")
        supplication_time_fajr = (fajr_time_dt + timedelta(minutes=15)).strftime("%H:%M:%S")
        schedule.every().day.at(supplication_time_fajr).do(
            send_supplication, 
            os.path.join(audio_files_path, "ุงุฐฺฉุงุฑ ุตุจุญ.mp3"),  # ูุณุฑ ฺฉุงูู ุจู ูุงู ุตูุช
            "ุงุฐฺฉุงุฑ ุตุจุญ ๐"
        )
        logging.info(f"ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ุตุจุญ ุจุฑุง ุณุงุนุช {supplication_time_fajr} ุชูุธู ุดุฏ.")

        # ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ุดุจ ุจุนุฏ ุงุฒ ููุงุฒ ุนุตุฑ
        asr_time = today_info['asr']
        asr_time_dt = datetime.strptime(asr_time, "%H:%M:%S")
        supplication_time_asr = (asr_time_dt + timedelta(minutes=15)).strftime("%H:%M:%S")
        schedule.every().day.at(supplication_time_asr).do(
            send_supplication, 
            os.path.join(audio_files_path, "ุงุฐฺฉุงุฑ ุดุจ.mp3"),  # ูุณุฑ ฺฉุงูู ุจู ูุงู ุตูุช
            "ุงุฐฺฉุงุฑ ุดุจ ๐"
        )
        logging.info(f"ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ุดุจ ุจุฑุง ุณุงุนุช {supplication_time_asr} ุชูุธู ุดุฏ.")

        # ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ูุจู ุฎูุงุจ ุจุนุฏ ุงุฒ ููุงุฒ ุนุดุง
        isha_time = today_info['isha']
        isha_time_dt = datetime.strptime(isha_time, "%H:%M:%S")
        supplication_time_isha = (isha_time_dt + timedelta(minutes=15)).strftime("%H:%M:%S")
        schedule.every().day.at(supplication_time_isha).do(
            send_supplication, 
            os.path.join(audio_files_path, "ุงุฐฺฉุงุฑ ูุจู ุฎูุงุจ.mp3"),  # ูุณุฑ ฺฉุงูู ุจู ูุงู ุตูุช
            "ุงุฐฺฉุงุฑ ูุจู ุฎูุงุจ ๐"
        )
        logging.info(f"ุฒูุงูโุจูุฏ ุงุฑุณุงู ุงุฐฺฉุงุฑ ูุจู ุฎูุงุจ ุจุฑุง ุณุงุนุช {supplication_time_isha} ุชูุธู ุดุฏ.")

        # ุฒูุงูโุจูุฏ ุงุฑุณุงู ุขู ุชุตุงุฏู
        schedule.every().day.at("08:00").do(random_quranic_verse)
        logging.info("ุฒูุงูโุจูุฏ ุงุฑุณุงู ุขู ุชุตุงุฏู ุชูุธู ุดุฏ.")

    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุฒูุงูโุจูุฏ ูุธุงู: {e}")

# ุงุฌุฑุง ุจุฑูุงูู
try:
    logging.info("ุดุฑูุน ุจุฑูุงูู...")
    schedule_tasks()

    # ุงุฌุฑุง ุฒูุงูโุจูุฏโูุง
    while True:
        schedule.run_pending()
        time.sleep(1)
except KeyboardInterrupt:
    logging.info("ุจุฑูุงูู ุจู ุตูุฑุช ุฏุณุช ูุชููู ุดุฏ.")
except Exception as e:
    logging.error(f"ุฎุทุง ุฑุฎ ุฏุงุฏ: {e}")
